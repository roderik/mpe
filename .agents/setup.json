{
  "agents": ["claude-code", "codex"],
  "mcpServers": {
    "linear": {
      "type": "http",
      "url": "https://mcp.linear.app/mcp"
    },
    "context7": {
      "type": "http",
      "url": "https://mcp.context7.com/mcp/oauth"
    },
    "octocode": {
      "command": "npx",
      "args": ["-y", "octocode-mcp@latest"]
    },
    "shadcn": {
      "command": "npx",
      "args": ["shadcn@latest", "mcp"]
    },
    "codex": {
      "command": "codex",
      "args": ["-m", "gpt-5.2-codex", "-c", "model_reasoning_effort=xhigh", "mcp-server"],
      "_note": "Claude Code only - do not configure in Codex"
    },
    "restate-docs": {
      "type": "http",
      "url": "https://docs.restate.dev/mcp"
    }
  },
  "workflow": {
    "title": "Development Workflow",
    "description": "Follow this workflow for all implementation tasks. Each phase is mandatory. If you deviate from this workflow, you MUST explain why and how you deviated. Exceptions: documentation-only, configuration-only, or research-only tasks may skip tests, but must state why.",
    "convergenceGuidance": {
      "principle": "Rule-of-Five: Iterative refinement until quality converges. First outputs are drafts, not finals.",
      "passProgression": "Each pass broadens scope: code → architecture → existential questions",
      "evidenceOverClaims": "Every pass must include evidence (test output, code citations, tool output), not just 'looks good'",
      "passByComplexity": {
        "trivial": "1-2 passes",
        "standard": "3 passes",
        "complex": "4-5 passes",
        "critical": "5+ passes"
      },
      "strongStopSignals": ["Zero findings", "Only cosmetic issues", "Agent declares convergence", "Confidence >= 8/10"],
      "weakStopSignals": ["Diminishing severity (P1→P2→P3)", "Smaller diffs each pass", "Faster completion"],
      "continueSignals": ["P1/P2 findings emerging", "Scope expansion needed", "Untested dimensions remain"],
      "bannedPhrases": ["looks good", "tests pass (without output)", "no issues (without what was checked)", "should work"]
    },
    "principles": [
      "ALWAYS use latest package versions. Check npmjs.com, hub.docker.com, pypi.org for current versions before installing.",
      "Never hardcode old versions unless explicitly required for compatibility.",
      "Use @latest, :latest tags, or explicit newest version numbers.",
      "When adding dependencies, verify the package exists and note the current version."
    ],
    "phases": [
      {
        "name": "Planning",
        "trigger": "Skill({ skill: \"plan-mode:planning-methodology\" })",
        "alias": "/plan",
        "steps": [
          {
            "action": "Gather context",
            "tool": "Task({ subagent_type: \"plan-mode:context-researcher\" })",
            "note": "Start with local CLI repo discovery: `rg --files`, `git ls-files`, `ls`, `sed -n '1,200p' file`. If `rg` is missing, use `find . -type f` and `grep -R \"pattern\" .`."
          },
          {
            "action": "Repo-wide search (if needed)",
            "tool": "mcp__octocode__githubSearchCode",
            "condition": "MCP configured",
            "note": "If MCP is configured, use mcp__octocode__* (githubSearchCode, githubGetFileContent, githubViewRepoStructure). Otherwise use local CLI: `rg \"pattern\"`, `rg --files`, `git ls-files`."
          },
          {
            "action": "Check docs",
            "tool": "Skill({ skill: \"context7\" })",
            "note": "If MCP is configured, use mcp__context7__resolve-library-id then mcp__context7__query-docs. Otherwise use local docs/README and CLI search: `rg \"term\" docs`, `rg \"term\" README.md`."
          },
          {
            "action": "Non-greenfield?",
            "tool": "Skill({ skill: \"systematic-debugging\" })",
            "note": "understand existing behavior first"
          },
          {
            "action": "Draft plan",
            "note": "exact file paths, code snippets, 2-5 minute tasks"
          },
          {
            "action": "Deep reasoning review (Claude Code only)",
            "tool": "mcp__codex",
            "note": "Use codex MCP for architectural decisions and complex planning. Skip in Codex.",
            "condition": "complex features or architectural decisions"
          },
          {
            "action": "Find tracking issue",
            "tool": "mcp__linear__list_issues",
            "condition": "tracking work in Linear",
            "note": "If MCP Linear is configured, find the relevant issue first. Otherwise ask for the issue ID."
          },
          {
            "action": "Update tracking ticket with plan",
            "tool": "mcp__linear__create_comment",
            "condition": "tracking work in Linear",
            "note": "If MCP Linear is configured, add a plan summary comment. Otherwise include the plan summary in the response."
          }
        ]
      },
      {
        "name": "Plan Refinement",
        "iterations": 5,
        "note": "Rule-of-Five convergence: each pass broadens scope until zero findings",
        "convergence": {
          "passFocus": [
            { "pass": 1, "focus": "Completeness", "question": "All areas covered? Goals clear?" },
            { "pass": 2, "focus": "Clarity", "question": "Can agent implement with zero questions?" },
            { "pass": 3, "focus": "Testability", "question": "All success criteria measurable?" },
            { "pass": 4, "focus": "Boundaries", "question": "Always/Ask/Never defined? No vague language?" },
            { "pass": 5, "focus": "Strategic", "question": "Right problem? Right scope? Future-proof?" }
          ],
          "stopWhen": ["Zero new findings", "Only cosmetic issues", "Agent declares convergence"],
          "continueWhen": ["P1/P2 findings still emerging", "Vague language remains", "Untested dimensions"],
          "evidenceRequired": "Each pass must cite specific findings with locations, not just 'looks good'"
        },
        "steps": [
          {
            "tool": "Task({ subagent_type: \"build-mode:spec-reviewer\", prompt: \"Review plan against requirements\" })"
          },
          { "tool": "Skill({ skill: \"ask-questions-if-underspecified\" })" },
          {
            "tool": "mcp__codex (Claude Code) or manual deep review (Codex)",
            "note": "Use codex MCP for deep reasoning review if available"
          },
          { "action": "Document findings with evidence markers, update plan" }
        ],
        "deepen": [
          "requirements clarity",
          "edge cases",
          "error handling",
          "test strategy"
        ]
      },
      {
        "name": "Implementation",
        "trigger": "Skill({ skill: \"subagent-driven-development\" })",
        "with": "Skill({ skill: \"executing-plans\" })",
        "ironLaw": "No production code without a failing test first",
        "perTask": [
          { "tool": "TodoWrite({ status: \"in_progress\" })" },
          {
            "tool": "Skill({ skill: \"test-driven-development\" })",
            "note": "RED: Write failing test FIRST"
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:task-implementer\" })",
            "note": "GREEN: Minimal code"
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:spec-reviewer\" })",
            "note": "Verify spec compliance"
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:quality-reviewer\" })",
            "note": "Code quality check"
          },
          { "tool": "TodoWrite({ status: \"completed\" })" }
        ]
      },
      {
        "name": "Cleanup",
        "note": "After all tasks complete",
        "steps": [
          {
            "tool": "Skill({ skill: \"code-simplifier\" })",
            "note": "Refine for clarity"
          },
          {
            "tool": "Skill({ skill: \"claude-md-improver\" })",
            "condition": "CLAUDE.md needs maintenance",
            "note": "Run after major doc or workflow changes."
          },
          {
            "tool": "Skill({ skill: \"deslop\" })",
            "note": "Remove AI-generated slop"
          },
          {
            "tool": "Skill({ skill: \"knip\" })",
            "note": "Remove unused code/deps"
          }
        ]
      },
      {
        "name": "Testing",
        "command": "bun run ci\n\nor if not available:\n\nbun run lint\nbun run test",
        "steps": [
          {
            "tool": "Skill({ skill: \"agent-browser\" })",
            "condition": "UI components",
            "note": "Preferred for UI checks. If unavailable, fall back to Playwright CLI (e.g. `npx playwright install` then run project UI checks)."
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:visual-tester\" })",
            "condition": "UI changes"
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:silent-failure-hunter\" })",
            "note": "Find error handling gaps"
          }
        ]
      },
      {
        "name": "Review",
        "trigger": "Skill({ skill: \"build-mode:review\" })",
        "alias": "/review",
        "iterations": 5,
        "note": "Rule-of-Five convergence for code review",
        "convergence": {
          "passFocus": [
            { "pass": 1, "focus": "Standard Review", "question": "Bugs? Edge cases? Test coverage?" },
            { "pass": 2, "focus": "Deep Review", "question": "Error handling? Naming? Duplication?" },
            { "pass": 3, "focus": "Architecture", "question": "Patterns? Dependencies? YAGNI violations?" },
            { "pass": 4, "focus": "Security", "question": "Injection? Auth? Data exposure?" },
            { "pass": 5, "focus": "Existential", "question": "Right problem? Right approach? Future-proof?" }
          ],
          "stopWhen": ["Zero new findings", "Only cosmetic issues", "Confidence >= 8/10"],
          "continueWhen": ["P1/P2 findings still emerging", "Architecture not reviewed", "Security not checked"],
          "evidenceRequired": "Test output with counts, code citations with line numbers, tool output"
        },
        "steps": [
          { "tool": "Task({ subagent_type: \"build-mode:code-reviewer\" })" },
          {
            "tool": "mcp__codex (Claude Code only)",
            "note": "Deep reasoning review for complex logic - skip in Codex"
          },
          {
            "tool": "Task({ subagent_type: \"build-mode:security-reviewer\" })",
            "condition": "auth/data/payments"
          },
          {
            "tool": "Skill({ skill: \"differential-review\" })",
            "note": "Security-focused diff review"
          }
        ]
      },
      {
        "name": "Verification",
        "trigger": "Skill({ skill: \"verification-before-completion\" })",
        "iterations": 5,
        "ironLaw": "Never claim completion without fresh verification evidence",
        "note": "Rule-of-Five convergence: evidence-based verification passes",
        "convergence": {
          "passFocus": [
            { "pass": 1, "focus": "Tests Pass", "evidence": "Test output: X tests, 0 failures" },
            { "pass": 2, "focus": "Lint Clean", "evidence": "Lint output: 0 errors, 0 warnings" },
            { "pass": 3, "focus": "Build Success", "evidence": "Build exit code 0" },
            { "pass": 4, "focus": "Spec Compliance", "evidence": "Each requirement mapped to test/code" },
            { "pass": 5, "focus": "Final Confidence", "evidence": "Self-assessment >= 8/10 with justification" }
          ],
          "stopWhen": ["All evidence markers present", "Exit codes all 0", "Confidence >= 8/10"],
          "continueWhen": ["Any test failing", "Warnings present", "Spec gaps identified"],
          "evidenceFormat": "## Pass N: [Focus] - EVIDENCE\n- ✓ [Marker]: `actual output`\n- Finding: [issue] at [location] - FIXED"
        },
        "steps": [
          {
            "tool": "Task({ subagent_type: \"build-mode:completion-validator\" })"
          },
          { "command": "bun run ci" },
          { "action": "Document evidence: exit codes, test counts, warnings" },
          { "action": "If issues: Fix, document fix, restart loop" },
          { "action": "Update README.md and docs if behavior changed" },
          {
            "tool": "mcp__linear__update_issue",
            "note": "If MCP Linear is configured, use mcp__linear__* (list_issues, get_issue, update_issue, create_comment). Otherwise leave a status note in the response.",
            "condition": "tracking work in Linear"
          }
        ]
      }
    ],
    "mcpServersReference": [
      { "server": "context7", "tools": "resolve-library-id, query-docs", "purpose": "Up-to-date library documentation" },
      { "server": "octocode", "tools": "githubSearchCode, githubGetFileContent, githubViewRepoStructure, packageSearch", "purpose": "GitHub code search and exploration" },
      { "server": "linear", "tools": "list_issues, get_issue, create_issue, update_issue, create_comment", "purpose": "Issue tracking and project management" },
      { "server": "shadcn", "tools": "add, diff, list", "purpose": "shadcn/ui component generation and management" },
      { "server": "codex", "tools": "deep-reasoning, code-review, architecture-analysis", "purpose": "Deep code reasoning with gpt-5.2-codex (Claude Code only)", "_note": "Do not configure in Codex" },
      { "server": "restate-docs", "tools": "query", "purpose": "Restate durable execution framework documentation" }
    ],
    "quickReference": [
      { "phase": "Plan", "tool": "/plan", "purpose": "Structure approach" },
      {
        "phase": "Refine",
        "tool": "spec-reviewer + questions",
        "purpose": "Perfect the plan"
      },
      {
        "phase": "Build",
        "tool": "subagent-driven-development",
        "purpose": "TDD implementation"
      },
      { "phase": "Clean", "tool": "deslop + knip", "purpose": "Remove cruft" },
      {
        "phase": "Test",
        "tool": "bun run ci (or lint+test) + agent-browser",
        "purpose": "Verify behavior"
      },
      { "phase": "Review", "tool": "/review", "purpose": "Quality gate" },
      {
        "phase": "Verify",
        "tool": "verification-before-completion",
        "purpose": "Evidence-based completion"
      }
    ]
  },
  "postInstall": {
    "darwin": [
      "brew install jq graphviz poppler semgrep uv ripgrep",
      "brew install --cask libreoffice codeql"
    ],
    "linux": [
      "if command -v apt-get >/dev/null 2>&1; then (sudo -n apt-get update -qq && sudo -n apt-get install -y jq ripgrep graphviz poppler-utils) || (apt-get update -qq && apt-get install -y jq ripgrep graphviz poppler-utils) || true; fi"
    ],
    "common": [
      "uv pip install --system --break-system-packages 'markitdown[pptx]' defusedxml",
      "npm install -g agent-browser@latest pptxgenjs@latest playwright@latest knip@latest",
      "agent-browser install",
      "npx playwright@latest install"
    ]
  },
  "skills": [
    {
      "repo": "better-auth/skills",
      "skills": ["better-auth-best-practices", "create-auth-skill"]
    },
    {
      "repo": "vercel-labs/agent-skills",
      "skills": ["vercel-react-best-practices"]
    },
    {
      "repo": "anthropics/claude-plugins-official",
      "skills": ["claude-md-improver", "claude-automation-recommender"]
    },
    {
      "repo": "vercel-labs/agent-browser",
      "skills": ["agent-browser"]
    },
    {
      "repo": "anthropics/skills",
      "skills": ["xlsx", "pptx", "doc-coauthoring"]
    },
    {
      "repo": "obra/superpowers",
      "skills": [
        "test-driven-development",
        "systematic-debugging",
        "verification-before-completion",
        "executing-plans",
        "writing-skills",
        "subagent-driven-development",
        "dispatching-parallel-agents"
      ]
    },
    {
      "repo": "trailofbits/skills",
      "skills": [
        "ask-questions-if-underspecified",
        "semgrep",
        "property-based-testing",
        "sharp-edges",
        "guidelines-advisor",
        "secure-workflow-guide",
        "differential-review",
        "token-integration-analyzer",
        "fuzzing-obstacles",
        "variant-analysis",
        "codeql",
        "sarif-parsing"
      ]
    },
    {
      "repo": "jezweb/claude-skills",
      "skills": ["tanstack-query"]
    },
    {
      "repo": "boristane/agent-skills",
      "skills": ["logging-best-practices"]
    },
        {
      "repo": "wshobson/agents",
      "skills": ["typescript-advanced-types"]
    },
    {
      "repo": "simonwong/agent-skills",
      "skills": ["code-simplifier"]
    },
    {
      "repo": "brianlovin/claude-config",
      "skills": ["deslop", "rams", "knip"]
    }
  ],
  "skillRouting": {
    "description": "Hierarchical skill routing by domain. Use category to narrow selection, then match triggers.",
    "categories": [
      {
        "name": "Planning & Context",
        "triggers": ["plan", "design", "architect", "requirements", "context", "docs", "documentation lookup"],
        "skills": [
          { "name": "plan-mode:planning-methodology", "triggers": ["/plan", "plan this", "design approach", "implementation plan"] },
          { "name": "ask-questions-if-underspecified", "triggers": ["unclear", "ambiguous", "need clarification", "missing requirements"] },
          { "name": "context7", "triggers": ["library docs", "API reference", "how does X work", "current docs for"], "note": "Prefer mcp__context7__* if MCP configured" }
        ]
      },
      {
        "name": "Implementation",
        "triggers": ["implement", "build", "code", "write", "create feature"],
        "skills": [
          { "name": "test-driven-development", "triggers": ["TDD", "write test first", "red-green-refactor", "before implementation"] },
          { "name": "subagent-driven-development", "triggers": ["execute plan", "parallel tasks", "spawn agents"] },
          { "name": "executing-plans", "triggers": ["follow plan", "implement plan", "execute steps"] },
          { "name": "dispatching-parallel-agents", "triggers": ["parallel", "concurrent tasks", "independent tasks", "2+ tasks"] }
        ]
      },
      {
        "name": "Code Quality",
        "triggers": ["review", "quality", "clean", "refactor", "lint", "unused"],
        "skills": [
          { "name": "mcp__codex (Claude Code)", "triggers": ["/review", "code review", "review changes", "deep review"], "note": "Use codex MCP for deep reasoning review - Claude Code only" },
          { "name": "code-simplifier", "triggers": ["simplify", "cleaner", "more readable", "reduce complexity"] },
          { "name": "deslop", "triggers": ["AI slop", "unnecessary comments", "defensive checks", "clean up generated"] },
          { "name": "knip", "triggers": ["unused", "dead code", "unused exports", "unused dependencies"] },
          { "name": "verification-before-completion", "triggers": ["done?", "complete?", "verify", "before commit", "before PR"] },
          { "name": "rams", "triggers": ["accessibility", "WCAG", "a11y", "visual design review"] }
        ]
      },
      {
        "name": "Security",
        "triggers": ["security", "vulnerability", "audit", "CVE", "OWASP", "injection"],
        "skills": [
          { "name": "semgrep", "triggers": ["semgrep", "SAST", "pattern scan", "quick security scan"] },
          { "name": "codeql", "triggers": ["codeql", "taint tracking", "data flow", "deep security analysis"] },
          { "name": "differential-review", "triggers": ["PR security", "diff review", "security regression", "blast radius"] },
          { "name": "variant-analysis", "triggers": ["similar bugs", "bug variants", "pattern hunting", "find other instances"] },
          { "name": "sarif-parsing", "triggers": ["SARIF", "scan results", "aggregate findings", "security report"] },
          { "name": "sharp-edges", "triggers": ["footgun", "misuse", "dangerous API", "secure defaults", "pit of success"] }
        ]
      },
      {
        "name": "Debugging",
        "triggers": ["bug", "error", "broken", "not working", "fix", "debug"],
        "skills": [
          { "name": "systematic-debugging", "triggers": ["investigate", "root cause", "why failing", "trace error"], "note": "Use BEFORE proposing fixes" }
        ]
      },
      {
        "name": "Testing",
        "triggers": ["test", "spec", "coverage", "browser test", "e2e"],
        "skills": [
          { "name": "property-based-testing", "triggers": ["property test", "fuzzing", "quickcheck", "hypothesis", "edge cases"] },
          { "name": "agent-browser", "triggers": ["browser", "e2e", "visual test", "screenshot", "form fill", "web automation"] }
        ]
      },
      {
        "name": "Documentation & Files",
        "triggers": ["doc", "write", "spreadsheet", "presentation", "xlsx", "pptx"],
        "skills": [
          { "name": "doc-coauthoring", "triggers": ["write doc", "proposal", "tech spec", "decision doc", "RFC"] },
          { "name": "xlsx", "triggers": [".xlsx", "spreadsheet", "Excel", "CSV analysis", "formulas"] },
          { "name": "pptx", "triggers": [".pptx", "presentation", "PowerPoint", "slides"] },
          { "name": "writing-skills", "triggers": ["create skill", "new skill", "skill development"] },
          { "name": "claude-md-improver", "triggers": ["CLAUDE.md", "improve claude config", "audit CLAUDE.md"] }
        ]
      },
      {
        "name": "Web3 & Smart Contracts",
        "triggers": ["solidity", "smart contract", "ERC", "blockchain", "web3", "defi"],
        "skills": [
          { "name": "guidelines-advisor", "triggers": ["contract review", "solidity best practices", "Trail of Bits"] },
          { "name": "secure-workflow-guide", "triggers": ["Slither", "security diagram", "fuzzing properties"] },
          { "name": "token-integration-analyzer", "triggers": ["ERC20", "ERC721", "token integration", "weird tokens"] },
          { "name": "fuzzing-obstacles", "triggers": ["fuzzer blocked", "checksum", "bypass for fuzzing"] }
        ]
      },
      {
        "name": "Framework-Specific",
        "triggers": ["React", "Next.js", "TypeScript", "auth", "query"],
        "skills": [
          { "name": "vercel-react-best-practices", "triggers": ["React perf", "Next.js", "bundle size", "SSR", "RSC"] },
          { "name": "tanstack-query", "triggers": ["TanStack", "React Query", "useQuery", "useMutation", "server state"] },
          { "name": "typescript-advanced-types", "triggers": ["generic", "conditional type", "mapped type", "infer", "template literal"] },
          { "name": "better-auth-best-practices", "triggers": ["Better Auth", "auth setup", "session", "OAuth"] },
          { "name": "create-auth-skill", "triggers": ["add auth", "auth layer", "authentication feature"] }
        ]
      },
      {
        "name": "Tooling & Meta",
        "triggers": ["setup", "configure", "automate", "logging"],
        "skills": [
          { "name": "claude-automation-recommender", "triggers": ["Claude Code setup", "hooks", "MCP", "automation recommendations"] },
          { "name": "logging-best-practices", "triggers": ["logging", "canonical log", "wide events", "structured logs"] }
        ]
      }
    ]
  }
}
